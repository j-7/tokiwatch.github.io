---
layout: post
title: "D21HWの設定ではまる(MacOSX)"
date: 2009-03-04 05:04:00 +0900
comments: false
categories: ['Mac']
---


出張が続くのと、来年度長距離通勤になるため、イーモバイルのD21HWを導入した。

ソフトバンクのイーモバイル回線網を利用したMVNOに期待していたのだが、SIMカードを入れ替えなければならないとか、契約が面倒そうとか、従量制と固定制の仕分けがややこしそうなどなどの理由で、若干幻滅したというのが理由である。

ところが、購入して設定しようとしたところ、ものすごくはまった。

正直近年まれに見るはまりっぷりだったので、ここに状況と解決までの顛末をまとめておく。

なお、コンピュータはMacBook(late2008) OSのバージョンはMacOSX10.5.6である。

D21HWは本体内のフラッシュディスクにドライバのインストーラが含まれているので、ドライバがインストールされていない場合、このフラッシュディスクがマウントされる。通常はこのインストーラを起動すれば、インストールの処理がマニュアル通り開始される。このインストールでモデムのドライバがインストールされる。問題はこの後に発生する。

インストールが完了すると「EMOBILE HW ユーティリティ」というソフトが起動するのだが、一部のユーザはこのソフトが起動後、しばらくして落ちるという障害にみまわれる。

そして、手動で「システム環境設定」の「ネットワーク」から設定をすると、「認証中」のところから先にプロセスが進まない。という状態になる。

ところが、他の人のデバイス(D21HWの本体)で試してみると、ちゃんと接続される場合がある。

この原因は追跡しきれなかったが、キーチェーンとか、ハードウェアDBも絡んでいるらしい。

この障害の根本的な原因は、実は「システム環境設定」の「ネットワーク」の「ネットワークの設定」が「自動」になっている場合に発生する。

どうやら、ネットワーク設定のプロファイルが「自動」だとロックされてしまうらしい。

そのため、ネットワークの設定ファイルにD21HWの情報を書き込もうとしても書き込むことができず落ちるのだ。

また、不用意に再インストールをすると、ドライバが複数ある状態になったり、キーチェーンに登録情報が複数書き込まれしまう場合がある。

これもおかしなことを発生させることがある。

解決策は以下の流れになる。

1. D21HWを抜き、再起動。

2. すでにインストールしてしまっている場合は、全てのドライバをアンインストール。キーチェーンの情報も削除。

3. D21HWをUSBに接続し、ドライバをインストールする。(インストール後、「EMOBILE HW ユーティリティ」が自動で起動するがすぐ落ちるがこれは正常なので気にしない)

4. 「ネットワークの設定」で「ネットワークを編集…」から新規でネットワークの設定を作成する。

5. イーモバイルのドライバを設定する。電話番号とユーザ名、パスワードを設定する必要がある。それぞれのパラメータはマニュアルを参照。

6. 「EMOBILE HW ユーティリティ」を起動する。(この時点で起動すれば、問題は解決している)

7. 「EMOBILE HW ユーティリティ」で接続。

8. 上記の作業でまだユーティリティが落ちるならば、ネットワークから手動で接続し、接続されれば設定は完了。(ちなみに、ユーティリティも起動するようになっているはずである。)

(だめな場合は、最後の3つの作業を2回くらいくりかえす。どうも順位ははっきりしないが、ユーティリティと「ネットワーク」で設定を書き合っているようだ。)

以上。

* 謝辞

この原因の解決には、ヨドバシカメラ新宿西口本店南館、イーモバイル販売窓口担当の方にご協力をいただきました。この場で感謝をいたします。

