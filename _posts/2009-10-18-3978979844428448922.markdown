---
layout: post
title: "MovableType5(beta)のMAMPへのインストール"
date: 2009-10-18 07:55:00 +0900
comments: false
categories: ['MAMP', 'Mac', 'MT5', 'unix', 'MovableType5']
---
\#周囲から読み難いからなんとかしろ、とかいろいろ指摘を頂戴したので、修正します。ごめんなさい。

----

Mac上でMT5betaのテスト環境を構築する必要が生じたので、構築するついでに手順をまとめておく。めずらしく丁寧めに書くので、長い。

なお、この手順通りやって失敗しても責任は持ちません。ご自身の責任でお願いしたい。

----

**構築するMT5betaテスト環境のコンセプト**

* データベースはmysql

* ウェブサーバ等はMANP

**理由：**

* SQLiteだと後々めんどうくさい。

* Apatchとか一生懸命設定するのは面倒。

* テストが終ったらさっくりまとめて消去したい。

**構築に必要なもの（今回の構築に使用したもの）**

* Mac（MacOS10.5以上）

* Xcode （最新のもの）

* MAMP 1.4.1

* MacPorts 1.8.1

* MovableType5 beta3

**必要なスキル**

* Terminalでのunixコマンドによるファイルの操作

**その他**

* アドミンの権限

**下準備**

1. XCODEをインストール

2. MacPortsをインストール

3. Terminalから以下のコマンドを入力し、MacPortsのPortsの情報を最新にする。

	`

	sudo port selfupdate

	sudo port sync

	sudo port upgrade outdated

	`

4. MT5が必要とするperl moduleをインストールする。

	`

	sudo port install imagemagick +perl

	sudo port install p5-dbd-mysql

	sudo port install p5-dbd-sqlite

	sudo port install p5-dbd-sqlite2

	sudo port install p5-gd

	sudo port install p5-crypt-dsa

	sudo port install p5-archive-zip

	sudo port install p5-xml-atom

	sudo port install p5-mail-sendmail

	sudo port install p5-xml-parser

	sudo port install p5-ipc-run

	`

    注：MacPortsをすでに利用している人向けの話

    

    imagemagickが先にインストールされているとうまくmakeが通らない場合があるので、+perlではないimagemagickは、uninstallしてください。

5. MAMPのインストール

ダウンロードは[こちらから][1]

（下のほうに無償版へのリンクがある。）

6. MT5の設置・設定

ダウンロードは[こちらから][2]

	`

	ダウンロードしたファイルを解凍。

	フォルダ名をMT5-***から、mt5betaへ変更。

	mt5beta/mt-staticを、/Application/MAMP/htdocs/mt5beta/mt-staticへ移動

	mt5betaを、/Application/MAMP/cgi-bin/mt5betaへ移動

	`

7. perlのパスをごにょごにょする

	`

	sudo mv /usr/bin/perl /usr/bin/perl.orginal

	sudo ln -s /opt/local/bin/perl /usr/bin/perl

	`

    注意：mt\*.cgiの冒頭のprelへのパスに対応する措置。

    

    あまりエレガントな方法ではないが、今回は、MacOSX10.6の一部としてすでに入っているperl(/usr/bin/perl)を、MacPortsでインストールされたperl (/opt/local/bin/perl)で置き換えるために、/usr/bin/perlの名前を変更し、/opt/local/bin/perlへのシンボリックリンク/usr/bin/perlを作成した。

    もう一つの方法としては、mt5beta/の中のcgiファイルの冒頭の"#!/usr/bin/perl -w"を、全部"#!/opt/local/bin/perl -w"に書き換えるという方法がある。このあたりはお好みで。

8. MAMPを起動

ブラウザが起動し、MAMPのスタートページが表示される。

次の設定に必要なのでこのページは閉じないこと。

9. データベースの作成

    スタートページの「phpMyAdmin」タブを選択する。

    

    「新規データベースを作成する」の下のボックスに作成したいデータベース名を入力し「作成」ボタンを選択する。

    

    \#パスワード変更などはお好みで。

----

**MT5betaの設定**

1. MT5betaのパスの設定

  1. http://localhost:8888/cgi-bin/mt5beta/mt-wizard.cgi を開く。

  2. 以下のように設定し、「開始」ボタンを選択する。

	`

	スタティックウェブパス：http://localhost:8888/mt5beta/mt-static/

	スタティックファイルパス：/Applications/MAMP/htdocs/mt5beta/mt-static

	`

2. モジュールを確認する。

    下準備が正しければ、特にアラートは出ないはずなのであっさり「次へ」ボタンを選択する。

* データベースの設定

  1. 今回のコンセプトに沿って「MySQLデータベース（推奨）」をプルダウンメニューから選択する。

  2. 以下の情報を入力する。

	`

	データベースサーバ：localhost

	データベース名：（phpMyAdminで作成したデータベース名）

	ユーザ名：root

	パスワード：root

	`

  3. 「高度な設定」ボタンをクリックし以下を設定し、「接続テスト」を選択する。

  4. 以下の情報を入力する。

	`

	データベースポート：8889

	データベースソケット：/Applications/MAMP/tmp/mysql/mysql.sock

	`

  5. 「接続テスト」を選択する。

  6. データベースに無事接続できたことを確認し、「次へ」を選択する。

* メール設定

    お好みで。

    

    特に設定をしなくても設定は続けられる。

    

    「次へ」を選択する。

* 設定の完了

    特に変なことがなければ、これにて設定は完了。

    

    あとはアカウント等の設定をしましょう。

  [1]: http://www.mamp.info/en/downloads/index.html

  [2]: http://www.movabletype.jp/beta/50/